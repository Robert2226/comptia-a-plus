# Lab 3: macOS Anti-Malware

## Objective
Investigate macOS’s built-in malware defense tools including XProtect, Gatekeeper, and MRT.

---

## Part 1: Gatekeeper Status (CLI)

Check if Gatekeeper is enabled by running:

```bash
spctl --status

```
```
### Output
assessments enabled
```
---

## Part 2: Gatekeeper GUI Behavior

Tried to open an application from an unidentified developer to trigger Gatekeeper’s warning prompt.

### Result:
Did not trigger a Gatekeeper warning in this test.

### Notes:
- Gatekeeper blocks apps from unidentified developers by default when opened via Finder
- A popup usually says: *"App can't be opened because it is from an unidentified developer"*
- This test can be completed using a `.dmg` or `.pkg` file from GitHub or a trusted open-source app


## Part 3: XProtect Malware Signatures

macOS uses XProtect to silently scan applications and files for known malware threats using up-to-date definitions.

### Attempted Command:

```bash
defaults read /System/Library/CoreServices/XProtect.bundle/Contents/Info.plist

### Results:

File Not Found - path may have changed in this macOS version.
```
### Alternate Verification:
```
system_profiler SPInstallHistoryDataType | grep -i xprotect

### Output Sample:

XProtectPlistConfigData
XProtectPayloads
XProtectCloudKitUpdate
...
(multiple entries)
```
---

## Part 4: MRT – Malware Removal Tool

MRT was historically used by macOS to remove known malware automatically, without user intervention. In modern macOS versions, it has been replaced or renamed under the broader **XProtect Remediator** framework.

### Attempted Command:

```bash
ls -l /System/Library/CoreServices/MRT.app

### Result:
No such file or directory - MRT.app is no longer present in this location.
```
```
### Alternate Check:
system_profiler SPInstallHistoryDataType | grep -i mrt

### Output
MRTConfigData
```
